
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Creating reports &#8212; LBS 0.13.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/asciinema-player_2.6.1.css" />
    <link rel="stylesheet" type="text/css" href="_static/asciinema-custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/contentui.css" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=1019fba8"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/asciinema-player_2.6.1.js"></script>
    <script src="_static/contentui.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reports';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Random numbers" href="random_numbers.html" />
    <link rel="prev" title="Profiling" href="profiling.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">LBS 0.13.0 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="part1.html">
    Introduction
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="part2.html">
    Structure of the framework
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part3.html">
    Basic simulation modules
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part4.html">
    Systematic effects
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part5.html">
    Data-reduction modules
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="part6.html">
    Tutorials
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="appendix.html">
    Appendices
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="installation.html">
    Installation
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="part1.html">
    Introduction
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="part2.html">
    Structure of the framework
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part3.html">
    Basic simulation modules
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part4.html">
    Systematic effects
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part5.html">
    Data-reduction modules
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part6.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="appendix.html">
    Appendices
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="installation.html">
    Installation
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="simulations.html">Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="imo.html">The IMo</a></li>
<li class="toctree-l1"><a class="reference internal" href="detectors.html">Detectors, channels, and instruments</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_fp.html">Focal plane visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="observations.html">Observations</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_layout.html">Data layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="profiling.html">Profiling</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Creating reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="random_numbers.html">Random numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="mpi.html">Multithreading and MPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrating.html">Integrating existing codes</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="part2.html" class="nav-link">Structure of the framework</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Creating reports</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="creating-reports">
<span id="reporting"></span><h1>Creating reports<a class="headerlink" href="#creating-reports" title="Link to this heading">#</a></h1>
<p>The LiteBIRD simulation framework has the ability to automatically
produce reports in the output directory specified during the creation
of a <a class="reference internal" href="simulations.html#litebird_sim.simulations.Simulation" title="litebird_sim.simulations.Simulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulation</span></code></a> object.</p>
<p>The framework uses the <a class="reference external" href="https://jinja.palletsprojects.com/en/2.11.x/">Jinja2</a> templating library to
render the text, and the <a class="reference external" href="https://python-markdown.github.io/">Python-Markdown</a> library to convert the text to
HTML.</p>
<p>The usage of the facility is easy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">litebird_sim</span> <span class="k">as</span> <span class="nn">lbs</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Create some plot</span>
<span class="n">data_points</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_points</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>

<span class="n">sim</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span><span class="n">base_dir</span><span class="o">=</span><span class="s2">&quot;./report_example&quot;</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">append_to_text</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2">## Section name</span>

<span class="s2">Here is some Markdown text written in *italic* and in **bold**.</span>

<span class="s2">Here is a list:</span>

<span class="s2">- One</span>
<span class="s2">- Two</span>
<span class="s2">- Three</span>

<span class="s2">The value of the variable `foo` is {{ foo }}.</span>

<span class="s2">And here is a figure:</span>

<span class="s2">![](myfigure.png)</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="n">figures</span><span class="o">=</span><span class="p">[(</span><span class="n">fig</span><span class="p">,</span> <span class="s2">&quot;myfigure.png&quot;</span><span class="p">)],</span>
    <span class="n">foo</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The method <a class="reference internal" href="simulations.html#litebird_sim.simulations.Simulation.append_to_report" title="litebird_sim.simulations.Simulation.append_to_report"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Simulation.append_to_report()</span></code></a> accepts arbitrary
keywords, which are substituted in the string whenever the form <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">…</span>
<span class="pre">}}</span></code> is found. Thus, the string <code class="docutils literal notranslate"><span class="pre">The</span> <span class="pre">value</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">variable</span> <span class="pre">`foo`</span> <span class="pre">is</span>
<span class="pre">{{</span> <span class="pre">foo</span> <span class="pre">}}</span></code> is converted into <code class="docutils literal notranslate"><span class="pre">The</span> <span class="pre">value</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">variable</span> <span class="pre">`foo`</span> <span class="pre">is</span>
<span class="pre">123</span></code>. The keyword <code class="docutils literal notranslate"><span class="pre">figures</span></code> is however interpreted directly by
<a class="reference internal" href="simulations.html#litebird_sim.simulations.Simulation.append_to_report" title="litebird_sim.simulations.Simulation.append_to_report"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Simulation.append_to_report()</span></code></a>: it must be a list of 2-tuples of
the form <code class="docutils literal notranslate"><span class="pre">(figure,</span> <span class="pre">filename)</span></code>, and it triggers the save of the
Matplotlib figure into a file with the specified name; you can refer
to the file using Markdown’s usual syntax <code class="docutils literal notranslate"><span class="pre">![](filename)</span></code>, as shown
in the example above.</p>
<section id="including-tables">
<h2>Including tables<a class="headerlink" href="#including-tables" title="Link to this heading">#</a></h2>
<p>Reports can include tables as well. They are formatted using the ASCII
characters <code class="docutils literal notranslate"><span class="pre">|</span></code> and <code class="docutils literal notranslate"><span class="pre">-</span></code>, as in the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">append_to_report</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2">Here is a table:</span>

<span class="s2">Column A   | Column B</span>
<span class="s2">---------- | ------------</span>
<span class="s2">Item 1 | Value 1</span>
<span class="s2">Item 2 | Value 2</span>
<span class="s2">Item 3 | Value 3</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you are going to write the rows of the table using Jinja2’s <code class="docutils literal notranslate"><span class="pre">for</span></code>
loops, be sure to end the loop with <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">endfor</span> <span class="pre">-%}</span></code> instead of <code class="docutils literal notranslate"><span class="pre">{%</span>
<span class="pre">endfor</span> <span class="pre">%}</span></code>, in order not to leave empty lines between consecutive rows.</p>
</section>
<section id="converting-the-report-to-other-formats">
<h2>Converting the report to other formats<a class="headerlink" href="#converting-the-report-to-other-formats" title="Link to this heading">#</a></h2>
<p>It might be the case that the report produced by your script contains
some complex table/paragraphs that you would like to include in an
article written in LaTeX or Microsoft Word. You can easily convert the
report into one of these formats using <a class="reference external" href="https://pandoc.org/">Pandoc</a>.</p>
<p>The Simulation Framework saves the Markdown source text of the report
in the same directory as <code class="docutils literal notranslate"><span class="pre">report.html</span></code>, and you can ask Markdown to
convert to some other format than HTML. The following shell commands
will produce files <code class="docutils literal notranslate"><span class="pre">report.tex</span></code> (LaTeX source), <code class="docutils literal notranslate"><span class="pre">report.docx</span></code>
(Microsoft Word file), and <code class="docutils literal notranslate"><span class="pre">report.pdf</span></code> (PDF file produced using
LaTeX):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ pandoc -f markdown -t latex -o report.tex report.md
$ pandoc -f markdown -t docx -o report.docx report.md
$ pandoc -f markdown -t latex -o report.pdf report.md
</pre></div>
</div>
<p>Any image included in the report is saved in the same directory as
<code class="docutils literal notranslate"><span class="pre">report.md</span></code> and <code class="docutils literal notranslate"><span class="pre">report.html</span></code>, so you can take and reuse them. To
ease the possibility to include images in the documents, you should
stick to the PNG image format, as it is easily embeddable in HTML,
pdfLaTeX/xeLaTeX/luaLaTeX, and Microsoft Word files. The alternative
is to manually convert the image files to other formats.</p>
<p>If the report contains mathematical equations, things get a little
trickier. You must create a text file with your favourite editor and
copy the following code in it (the file is available in the Python
distribution as <code class="docutils literal notranslate"><span class="pre">litebird_sim/misc/pandoc-filter.lua</span></code>):</p>
<div class="highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="c1">-- mode: lua</span>

<span class="c1">-- Pass the following option to pandoc:</span>
<span class="c1">--</span>
<span class="c1">--   pandoc --lua-filter gitlab-math.lua ...</span>
<span class="c1">--</span>
<span class="c1">-- to use this filter</span>

<span class="kr">function</span> <span class="nf">Math</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
   <span class="kr">if</span> <span class="n">el</span><span class="p">.</span><span class="n">mathtype</span> <span class="o">==</span> <span class="s2">&quot;InlineMath&quot;</span> <span class="kr">then</span>
      <span class="kr">if</span> <span class="n">el</span><span class="p">.</span><span class="n">text</span><span class="p">:</span><span class="n">sub</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;`&#39;</span> <span class="ow">and</span> <span class="n">el</span><span class="p">.</span><span class="n">text</span><span class="p">:</span><span class="n">sub</span><span class="p">(</span><span class="o">#</span><span class="n">el</span><span class="p">.</span><span class="n">text</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;`&#39;</span> <span class="kr">then</span>
         <span class="kd">local</span> <span class="n">text</span> <span class="o">=</span> <span class="n">el</span><span class="p">.</span><span class="n">text</span><span class="p">:</span><span class="n">sub</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">#</span><span class="n">el</span><span class="p">.</span><span class="n">text</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
         <span class="kr">return</span> <span class="n">pandoc</span><span class="p">.</span><span class="n">Math</span><span class="p">(</span><span class="n">el</span><span class="p">.</span><span class="n">mathtype</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
      <span class="kr">else</span>
         <span class="kd">local</span> <span class="n">cont</span> <span class="o">=</span> <span class="n">pandoc</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">el</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
         <span class="kr">return</span> <span class="p">{</span> <span class="n">pandoc</span><span class="p">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="p">)</span> <span class="p">}</span> <span class="o">..</span> <span class="n">cont</span><span class="p">.</span><span class="n">blocks</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">content</span> <span class="o">..</span> <span class="p">{</span> <span class="n">pandoc</span><span class="p">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;$&quot;</span><span class="p">)</span> <span class="p">}</span>
      <span class="kr">end</span>
   <span class="kr">end</span>
<span class="kr">end</span>

<span class="kr">function</span> <span class="nf">CodeBlock</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
   <span class="kr">if</span> <span class="n">el</span><span class="p">.</span><span class="n">classes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;math&quot;</span> <span class="kr">then</span>
      <span class="kr">return</span> <span class="n">pandoc</span><span class="p">.</span><span class="n">Para</span><span class="p">({</span> <span class="n">pandoc</span><span class="p">.</span><span class="n">Math</span><span class="p">(</span><span class="s2">&quot;DisplayMath&quot;</span><span class="p">,</span> <span class="n">el</span><span class="p">.</span><span class="n">text</span><span class="p">)</span> <span class="p">})</span>
   <span class="kr">end</span>
<span class="kr">end</span>
</pre></div>
</div>
<p>and save it somewhere in your computer; let’s suppose that the path is
<code class="docutils literal notranslate"><span class="pre">/my/scripts/litebird-sim-pandoc.lua</span></code> (better to use the extension
<code class="docutils literal notranslate"><span class="pre">.lua</span></code>, as this is a <a class="reference external" href="https://www.lua.org/">Lua</a> script). Then,
run pandoc with the option <code class="docutils literal notranslate"><span class="pre">--lua-filter</span>
<span class="pre">/my/scripts/litebird-sim-pandoc.lua</span></code> and the equations will be
converted properly. The following image shows the result of running
the filter on a report generated by an analysis script to convert the
report in a <code class="docutils literal notranslate"><span class="pre">docx</span></code> file:</p>
<img alt="_images/litebird_sim_sample_report_docx.png" src="_images/litebird_sim_sample_report_docx.png" />
<p>And here is a screenshot of one page of the PDF file that has been
produced by Pandoc by converting the same document to a LaTeX file:</p>
<img alt="_images/litebird_sim_sample_report_latex.png" src="_images/litebird_sim_sample_report_latex.png" />
<p>Converting reports to LaTeX is particularly handy when you want to
re-use tables written in the report, as these are notoriously a pain
to write manually in LaTeX.</p>
</section>
<section id="a-few-stylistical-tips">
<h2>A few stylistical tips<a class="headerlink" href="#a-few-stylistical-tips" title="Link to this heading">#</a></h2>
<section id="template-files">
<h3>Template files<a class="headerlink" href="#template-files" title="Link to this heading">#</a></h3>
<p>If the report is getting larger and larger, it is advisable to move
the string passed to <a class="reference internal" href="simulations.html#litebird_sim.simulations.Simulation.append_to_report" title="litebird_sim.simulations.Simulation.append_to_report"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Simulation.append_to_report()</span></code></a> in a
separate file and load it at runtime. (This is what we do in the
source code of the framework, see the folder
<code class="docutils literal notranslate"><span class="pre">litebird_sim/templates</span></code>.) For instance,
you could put the following text in a file <code class="docutils literal notranslate"><span class="pre">my_template_report.md</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Here is some number: {{ &quot;0.2f&quot; | format(val) }}
Blah blah blah

Here follows a few very long paragraphs...

And here some more text...
</pre></div>
</div>
<p>and then you would load it in your script in the following way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;my_template_report.md&quot;</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inpf</span><span class="p">:</span>
    <span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inpf</span><span class="o">.</span><span class="n">readlines</span><span class="p">())</span>

<span class="n">sim</span><span class="o">.</span><span class="n">append_to_report</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p>In this way, you can remove much clutter from the Python file, and it
is easier for people who want to improve the report to contribute, as
they do not need to understand Python to do it.</p>
</section>
<section id="where-to-put-the-formatting-logic">
<h3>Where to put the formatting logic<a class="headerlink" href="#where-to-put-the-formatting-logic" title="Link to this heading">#</a></h3>
<p>You should always try to put the formatting logic of the report within
the string passed to <a class="reference internal" href="simulations.html#litebird_sim.simulations.Simulation.append_to_report" title="litebird_sim.simulations.Simulation.append_to_report"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Simulation.append_to_report()</span></code></a>, possibly
using <a class="reference external" href="https://jinja.palletsprojects.com/en/2.11.x/templates/#filters">Jinja2’s filters</a>,
instead of formatting the arguments in your Python script. Thus,
instead of doing this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">append_to_report</span><span class="p">(</span>
    <span class="s2">&quot;Here is some number: {{ val }}&quot;</span><span class="p">,</span>
    <span class="n">val</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="p">,</span>    <span class="c1"># Don&#39;t do this!</span>
<span class="p">)</span>
</pre></div>
</div>
<p>you should do this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ok, put the formatting logic into the string and rely</span>
<span class="c1"># on Jinja2&#39;s filter named &quot;format&quot;</span>
<span class="n">sim</span><span class="o">.</span><span class="n">append_to_report</span><span class="p">(</span>
    <span class="s1">&#39;Here is some number: {{ &quot;0.2f&quot; | format(val) }}&#39;</span><span class="p">,</span>
    <span class="n">val</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The reason is that if you keep the template in a separate Markdown
file, as explained above, it is better to put whatever concerns the
<em>representation</em> of the values in the template instead of the code.
For instance, at some point you might revise the layout of your report
by adding space, and this might enable you to write some date field as
<code class="docutils literal notranslate"><span class="pre">February,</span> <span class="pre">8th</span> <span class="pre">2022</span></code> instead of <code class="docutils literal notranslate"><span class="pre">22-02-08</span></code>; this kind of change
should affect only the Markdown template and not the Python code,
because it’s the template that was modified to enable more space.</p>
<p>Try to follow this tip even for short snippets: in the authors’
experience, it is often the case that short reports grow more and more
as time passes, until at some point they are moved to separate
Markdown files!</p>
<p>You can refer to <a class="reference external" href="https://jinja.palletsprojects.com/en/2.11.x/templates/#filters">Jinja2’s documentation</a> for
a complete list of filters, but here is a selection of the most useful
ones:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">format(value)</span> <span class="pre">}}</span></code> formats <code class="docutils literal notranslate"><span class="pre">value</span></code> like the C function
<code class="docutils literal notranslate"><span class="pre">printf(str,</span> <span class="pre">value)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">var</span> <span class="pre">|</span> <span class="pre">round(n)</span> <span class="pre">}}</span></code> rounds <code class="docutils literal notranslate"><span class="pre">val</span></code> to <code class="docutils literal notranslate"><span class="pre">n</span></code> digits</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">var</span> <span class="pre">|</span> <span class="pre">filesizeformat</span> <span class="pre">}}</span></code> interprets <code class="docutils literal notranslate"><span class="pre">var</span></code> as a size in bytes
and formats it in a human-readable format. Examples: <code class="docutils literal notranslate"><span class="pre">13</span> <span class="pre">kB</span></code>, <code class="docutils literal notranslate"><span class="pre">4.1</span>
<span class="pre">MB</span></code>, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">var</span> <span class="pre">|</span> <span class="pre">upper</span> <span class="pre">}}</span></code> converts <code class="docutils literal notranslate"><span class="pre">var</span></code> (a string) to uppercase</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">var</span> <span class="pre">|</span> <span class="pre">lower</span> <span class="pre">}}</span></code> converts <code class="docutils literal notranslate"><span class="pre">var</span></code> (a string) to lowercase</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">var</span> <span class="pre">|</span> <span class="pre">capitalize</span> <span class="pre">}}</span></code> capitalizes <code class="docutils literal notranslate"><span class="pre">var</span></code> (a string), so that
<code class="docutils literal notranslate"><span class="pre">jupiter</span></code> is turned into <code class="docutils literal notranslate"><span class="pre">Jupiter</span></code>.</p></li>
</ul>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="profiling.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Profiling</p>
      </div>
    </a>
    <a class="right-next"
       href="random_numbers.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Random numbers</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#including-tables">Including tables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#converting-the-report-to-other-formats">Converting the report to other formats</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-few-stylistical-tips">A few stylistical tips</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#template-files">Template files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#where-to-put-the-formatting-logic">Where to put the formatting logic</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="_sources/reports.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2020, The LiteBIRD Simulation Team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>