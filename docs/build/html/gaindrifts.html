
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Gain drift injection &#8212; LBS 0.13.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/asciinema-player_2.6.1.css" />
    <link rel="stylesheet" type="text/css" href="_static/asciinema-custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/contentui.css" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=1019fba8"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/asciinema-player_2.6.1.js"></script>
    <script src="_static/contentui.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'gaindrifts';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Non-linearity injection" href="non_linearity.html" />
    <link rel="prev" title="Systematic effects" href="part4.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">LBS 0.13.0 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="part1.html">
    Introduction
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part2.html">
    Structure of the framework
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part3.html">
    Basic simulation modules
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="part4.html">
    Systematic effects
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part5.html">
    Data-reduction modules
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="part6.html">
    Tutorials
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="appendix.html">
    Appendices
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="installation.html">
    Installation
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="part1.html">
    Introduction
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part2.html">
    Structure of the framework
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part3.html">
    Basic simulation modules
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="part4.html">
    Systematic effects
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part5.html">
    Data-reduction modules
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part6.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="appendix.html">
    Appendices
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="installation.html">
    Installation
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Gain drift injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="non_linearity.html">Non-linearity injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="hwp_sys.html">HWP systematics</a></li>
<li class="toctree-l1"><a class="reference internal" href="pointing_sys.html">Pointing systematics</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="part4.html" class="nav-link">Systematic effects</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Gain drift injection</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="gain-drift-injection">
<h1>Gain drift injection<a class="headerlink" href="#gain-drift-injection" title="Link to this heading">#</a></h1>
<p>Gain drift is the systematic that is multiplicative to time-ordered
data. The LiteBIRD Simulation Framework provides a gain drift
simulation module based on the same module in <code class="docutils literal notranslate"><span class="pre">toast3</span></code>. Though the
exact nature of the gain drift depends on the specifics of the
electronics, the gain drift module provides the functions to simulate
two kinds of gain drifts:</p>
<ol class="arabic simple">
<li><p>Linear gain drifts;</p></li>
<li><p>Thermal gain drifts.</p></li>
</ol>
<p>For any gain drift, one can use either the method of
<a class="reference internal" href="simulations.html#litebird_sim.simulations.Simulation" title="litebird_sim.simulations.Simulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulation</span></code></a> class <a class="reference internal" href="simulations.html#litebird_sim.simulations.Simulation.apply_gaindrift" title="litebird_sim.simulations.Simulation.apply_gaindrift"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Simulation.apply_gaindrift()</span></code></a>, or
any of the low-level functions:
<a class="reference internal" href="#litebird_sim.gaindrifts.apply_gaindrift_to_observations" title="litebird_sim.gaindrifts.apply_gaindrift_to_observations"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_gaindrift_to_observations()</span></code></a>,
<a class="reference internal" href="#litebird_sim.gaindrifts.apply_gaindrift_to_tod" title="litebird_sim.gaindrifts.apply_gaindrift_to_tod"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_gaindrift_to_tod()</span></code></a>,
<a class="reference internal" href="#litebird_sim.gaindrifts.apply_gaindrift_for_one_detector" title="litebird_sim.gaindrifts.apply_gaindrift_for_one_detector"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_gaindrift_for_one_detector()</span></code></a>. The following example
shows the typical usage of the method and low-level functions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">litebird_sim</span> <span class="k">as</span> <span class="nn">lbs</span>
<span class="kn">from</span> <span class="nn">astropy.time</span> <span class="kn">import</span> <span class="n">Time</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="s2">&quot;2034-05-02&quot;</span><span class="p">)</span>
<span class="n">duration_s</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">3600</span>
<span class="n">sampling_freq_Hz</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Creating a list of detectors. The detector name is used as one of</span>
<span class="c1"># two seeds to introduce unique and reproducible randomness to the</span>
<span class="c1"># gain drift for each detector.</span>
<span class="n">dets</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">lbs</span><span class="o">.</span><span class="n">DetectorInfo</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;det_A_wafer_1&quot;</span><span class="p">,</span> <span class="n">sampling_rate_hz</span><span class="o">=</span><span class="n">sampling_freq_Hz</span><span class="p">,</span> <span class="n">wafer</span><span class="o">=</span><span class="s2">&quot;wafer_1&quot;</span>
    <span class="p">),</span>
    <span class="n">lbs</span><span class="o">.</span><span class="n">DetectorInfo</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;det_B_wafer_1&quot;</span><span class="p">,</span> <span class="n">sampling_rate_hz</span><span class="o">=</span><span class="n">sampling_freq_Hz</span><span class="p">,</span> <span class="n">wafer</span><span class="o">=</span><span class="s2">&quot;wafer_1&quot;</span>
    <span class="p">),</span>
    <span class="n">lbs</span><span class="o">.</span><span class="n">DetectorInfo</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;det_C_wafer_2&quot;</span><span class="p">,</span> <span class="n">sampling_rate_hz</span><span class="o">=</span><span class="n">sampling_freq_Hz</span><span class="p">,</span> <span class="n">wafer</span><span class="o">=</span><span class="s2">&quot;wafer_2&quot;</span>
    <span class="p">),</span>
<span class="p">]</span>

<span class="c1"># Defining the gain drift simulation parameters</span>
<span class="n">drift_params</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">GainDriftParams</span><span class="p">(</span>
    <span class="n">drift_type</span><span class="o">=</span><span class="n">lbs</span><span class="o">.</span><span class="n">GainDriftType</span><span class="o">.</span><span class="n">LINEAR_GAIN</span><span class="p">,</span>
    <span class="n">sampling_uniform_low</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">sampling_uniform_high</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">sim1</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span>
    <span class="n">base_path</span><span class="o">=</span><span class="s2">&quot;linear_gd_example&quot;</span><span class="p">,</span>
    <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
    <span class="n">duration_s</span><span class="o">=</span><span class="n">duration_s</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">sim1</span><span class="o">.</span><span class="n">create_observations</span><span class="p">(</span>
    <span class="n">detectors</span><span class="o">=</span><span class="n">dets</span><span class="p">,</span>
    <span class="n">split_list_over_processes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">num_of_obs_per_detector</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Creating fiducial TODs</span>
<span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">gain_2_self</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tod</span><span class="p">)</span>
<span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">gain_2_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tod</span><span class="p">)</span>
<span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">gain_2_tod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tod</span><span class="p">)</span>
<span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">gain_2_det</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tod</span><span class="p">)</span>

<span class="c1"># Applying gain drift using the `Simulation` class method</span>
<span class="n">sim1</span><span class="o">.</span><span class="n">apply_gaindrift</span><span class="p">(</span>
    <span class="n">drift_params</span><span class="o">=</span><span class="n">drift_params</span><span class="p">,</span>
    <span class="n">component</span><span class="o">=</span><span class="s2">&quot;gain_2_self&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Applying gain drift on the given TOD component of an `Observation` object</span>
<span class="n">lbs</span><span class="o">.</span><span class="n">apply_gaindrift_to_observations</span><span class="p">(</span>
    <span class="n">observations</span><span class="o">=</span><span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">,</span>
    <span class="n">drift_params</span><span class="o">=</span><span class="n">drift_params</span><span class="p">,</span>
    <span class="n">component</span><span class="o">=</span><span class="s2">&quot;gain_2_obs&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Applying gain drift on the TOD array. One must pass the name of the</span>
<span class="c1"># associated detectors (or just an array of string objects) to seed</span>
<span class="c1"># the reproducible randomness</span>
<span class="n">lbs</span><span class="o">.</span><span class="n">apply_gaindrift_to_tod</span><span class="p">(</span>
    <span class="n">tod</span><span class="o">=</span><span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">gain_2_tod</span><span class="p">,</span>
    <span class="n">sampling_freq_hz</span><span class="o">=</span><span class="n">sampling_freq_Hz</span><span class="p">,</span>
    <span class="n">det_name</span><span class="o">=</span><span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
    <span class="n">drift_params</span><span class="o">=</span><span class="n">drift_params</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Applying gain drift on the TOD arrays of the individual detectors.</span>
<span class="c1"># One must pass the name of the detector (or a string object) to seed</span>
<span class="c1"># the reproducible randomness.</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">tod</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">gain_2_det</span><span class="p">):</span>
    <span class="n">lbs</span><span class="o">.</span><span class="n">apply_gaindrift_for_one_detector</span><span class="p">(</span>
        <span class="n">det_tod</span><span class="o">=</span><span class="n">tod</span><span class="p">,</span>
        <span class="n">sampling_freq_hz</span><span class="o">=</span><span class="n">sampling_freq_Hz</span><span class="p">,</span>
        <span class="n">det_name</span><span class="o">=</span><span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="n">drift_params</span><span class="o">=</span><span class="n">drift_params</span><span class="p">,</span>
    <span class="p">)</span>

<span class="c1"># The four TODs we obtain this way are equal to each other.</span>
</pre></div>
</div>
<p>One has to specify the gain drift simulation parameters as an instance
of the <a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams" title="litebird_sim.gaindrifts.GainDriftParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">GainDriftParams</span></code></a> class. The type of the gain drift can
be selected using the enum class <a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftType" title="litebird_sim.gaindrifts.GainDriftType"><code class="xref py py-class docutils literal notranslate"><span class="pre">GainDriftType</span></code></a>. The
<a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams" title="litebird_sim.gaindrifts.GainDriftParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">GainDriftParams</span></code></a> class also offers the facility to specify
the distribution of the slope for the linear gain and the distribution
of the detector mismatch for the thermal gain, which can be specified
with the help of the enum class <a class="reference internal" href="#litebird_sim.gaindrifts.SamplingDist" title="litebird_sim.gaindrifts.SamplingDist"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamplingDist</span></code></a>.</p>
<p>Following is an example of linear gain drift simulation parameters
where the slope of gain for different detectors follows Gaussian
distribution with a mean of 0.8 and a standard deviation of 0.2:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">litebird_sim</span> <span class="k">as</span> <span class="nn">lbs</span>

<span class="n">drift_params</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">GainDriftParams</span><span class="p">(</span>
    <span class="n">drift_type</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">GainDriftType</span><span class="o">.</span><span class="n">LINEAR_GAIN</span><span class="p">,</span>
    <span class="n">sampling_dist</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">SamplingDist</span><span class="o">.</span><span class="n">GAUSSIAN</span><span class="p">,</span>
    <span class="n">sampling_gaussian_loc</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
    <span class="n">sampling_gaussian_scale</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The following example shows the thermal gain drift simulation
parameters where the detector mismatch within a detector group has a
uniform distribution varying between the factors 0.2 to 0.8:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">litebird_sim</span> <span class="k">as</span> <span class="nn">lbs</span>

<span class="n">drift_params</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">GainDriftParams</span><span class="p">(</span>
    <span class="n">drift_type</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">GainDriftType</span><span class="o">.</span><span class="n">THERMAL_GAIN</span><span class="p">,</span>
    <span class="n">sampling_dist</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">SamplingDist</span><span class="o">.</span><span class="n">UNIFORM</span><span class="p">,</span>
    <span class="n">sampling_uniform_low</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">sampling_uniform_high</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Refer to the <a class="reference internal" href="#gd-api-reference"><span class="std std-ref">API reference</span></a> for the full list of gain drift simulation parameters.</p>
<section id="linear-gain-drift">
<h2>Linear gain drift<a class="headerlink" href="#linear-gain-drift" title="Link to this heading">#</a></h2>
<p>Linear gain drift is the linearly increasing factor for TODs. The
<a class="reference internal" href="#module-litebird_sim.gaindrifts" title="litebird_sim.gaindrifts"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gaindrifts</span></code></a> module provides methods and functions to simulate
the linear gain drift with the possibility of periodic calibration.
The calibration event resets the gain factor to one periodically after
every calibration period interval. You can specify the calibration
period with the attribute
<a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams.calibration_period_sec" title="litebird_sim.gaindrifts.GainDriftParams.calibration_period_sec"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GainDriftParams.calibration_period_sec</span></code></a>. The following example
shows the time evolution of the linear gain drift factor over four
days with a calibration period of 24 hours:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">litebird_sim</span> <span class="k">as</span> <span class="nn">lbs</span>
<span class="kn">from</span> <span class="nn">astropy.time</span> <span class="kn">import</span> <span class="n">Time</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="s2">&quot;2034-05-02&quot;</span><span class="p">)</span>
<span class="n">duration_s</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">3600</span>
<span class="n">sampling_freq_Hz</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Creating a list of detectors.</span>
<span class="n">dets</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">lbs</span><span class="o">.</span><span class="n">DetectorInfo</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;det_A_wafer_1&quot;</span><span class="p">,</span> <span class="n">sampling_rate_hz</span><span class="o">=</span><span class="n">sampling_freq_Hz</span><span class="p">,</span> <span class="n">wafer</span><span class="o">=</span><span class="s2">&quot;wafer_1&quot;</span>
    <span class="p">),</span>
    <span class="n">lbs</span><span class="o">.</span><span class="n">DetectorInfo</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;det_B_wafer_1&quot;</span><span class="p">,</span> <span class="n">sampling_rate_hz</span><span class="o">=</span><span class="n">sampling_freq_Hz</span><span class="p">,</span> <span class="n">wafer</span><span class="o">=</span><span class="s2">&quot;wafer_1&quot;</span>
    <span class="p">),</span>
<span class="p">]</span>

<span class="c1"># Defining the gain drift simulation parameters</span>
<span class="n">drift_params</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">GainDriftParams</span><span class="p">(</span>
    <span class="n">drift_type</span><span class="o">=</span><span class="n">lbs</span><span class="o">.</span><span class="n">GainDriftType</span><span class="o">.</span><span class="n">LINEAR_GAIN</span><span class="p">,</span>
    <span class="n">calibration_period_sec</span><span class="o">=</span><span class="mi">24</span> <span class="o">*</span> <span class="mi">3600</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">sim1</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span>
    <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
    <span class="n">duration_s</span><span class="o">=</span><span class="n">duration_s</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">sim1</span><span class="o">.</span><span class="n">create_observations</span><span class="p">(</span>
    <span class="n">detectors</span><span class="o">=</span><span class="n">dets</span><span class="p">,</span>
    <span class="n">split_list_over_processes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">num_of_obs_per_detector</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lingain_tod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tod</span><span class="p">)</span>

<span class="c1"># Applying gain drift using the `Simulation` class method</span>
<span class="n">sim1</span><span class="o">.</span><span class="n">apply_gaindrift</span><span class="p">(</span>
    <span class="n">drift_params</span><span class="o">=</span><span class="n">drift_params</span><span class="p">,</span>
    <span class="n">component</span><span class="o">=</span><span class="s2">&quot;lingain_tod&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">time_domain</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tod</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">sampling_freq_Hz</span> <span class="o">/</span> <span class="mi">24</span> <span class="o">/</span> <span class="mi">3600</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tod</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">time_domain</span><span class="p">,</span>
        <span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lingain_tod</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="n">label</span><span class="o">=</span><span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
    <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time (in days)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Linear gain factor amplitude&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/96d1d92116c317651ba8d0c45fe2859c/lingain_demo.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/b1ff4303533b13878146528f9ad738d1/lingain_demo.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/8f658199a3d3cac5ea13995d60bf5bf5/lingain_demo.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/7c01310eac947c15d269f4ed7100811c/lingain_demo.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/lingain_demo.png" class="plot-directive" src="_images/lingain_demo.png" />
</figure>
<p>Note that the figure above shows only the nature of the linear gain
drift factor to be multiplied by the sky TOD.</p>
<p>The module generates different gain slopes for different detectors.
The factor <span class="math notranslate nohighlight">\(\sigma_{drift}\times\delta\)</span> determines the slope (or
the peak amplitude) of the linear gain, where <span class="math notranslate nohighlight">\(\sigma_{drift}\)</span>
is a dimensionless parameter specified by
<a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams.sigma_drift" title="litebird_sim.gaindrifts.GainDriftParams.sigma_drift"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GainDriftParams.sigma_drift</span></code></a> and <span class="math notranslate nohighlight">\(\delta\)</span> is the random
factor generated uniquely for each detector. The distribution of
<span class="math notranslate nohighlight">\(\delta\)</span> or, conversely, the distribution of the gain slopes
over all the detectors can be specified with attributes of
<a class="reference internal" href="#litebird_sim.gaindrifts.SamplingDist" title="litebird_sim.gaindrifts.SamplingDist"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamplingDist</span></code></a> enum class and the associated parameters listed
in <a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams" title="litebird_sim.gaindrifts.GainDriftParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">GainDriftParams</span></code></a>.</p>
</section>
<section id="thermal-gain-drift">
<h2>Thermal gain drift<a class="headerlink" href="#thermal-gain-drift" title="Link to this heading">#</a></h2>
<p>The thermal gain drift is modelled as the gain drift due to
<span class="math notranslate nohighlight">\(1/f\)</span> fluctuation in focalplane temperature. In the first step,
the <span class="math notranslate nohighlight">\(1/f\)</span> noise timestream is generated from oversampled power
spectral density given by</p>
<div class="math notranslate nohighlight">
\[S(f) = \sigma_{drift}^2\left(\frac{f_{knee}}{f}\right)^{\alpha_{drift}}\]</div>
<p>The noise timestream is considered to be the same for all the
detectors belonging to a given detector group. One may specify which
detector parameter to use to make a detector group, using the
attribute <a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams.focalplane_group" title="litebird_sim.gaindrifts.GainDriftParams.focalplane_group"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GainDriftParams.focalplane_group</span></code></a>. Valid values are
<cite>“wafer”</cite>, <cite>“pixtype”</cite>, or <cite>“channel”</cite>. For example, if
<code class="xref py py-attr docutils literal notranslate"><span class="pre">GainDriftParams.focalplane_group</span> <span class="pre">=</span> <span class="pre">&quot;wafer&quot;</span></code>, all the detectors
with the same wafer name will be considered in one group and have the
same noise timestream.</p>
<p>Once the noise timestreams are obtained for all the groups in the
focal plane, the code inserts a mismatch for the detectors within a
group by a random factor and the detector mismatch factor. We can
express the noise timestream with detector mismatch using the
following expression:</p>
<div class="math notranslate nohighlight">
\[t^{(mis)}_{stream} = (1 + \delta\times\alpha_{mis})t_{stream}\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha_{mis}\)</span> is the detector mismatch factor specified
using the attribute <a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams.detector_mismatch" title="litebird_sim.gaindrifts.GainDriftParams.detector_mismatch"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GainDriftParams.detector_mismatch</span></code></a> and
<span class="math notranslate nohighlight">\(\delta\)</span> is the random factor generated uniquely for each
detector. The distribution of <span class="math notranslate nohighlight">\(\delta\)</span> or, conversely, the
distribution of noise timestream mismatch can be specified with
attributes of <a class="reference internal" href="#litebird_sim.gaindrifts.SamplingDist" title="litebird_sim.gaindrifts.SamplingDist"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamplingDist</span></code></a> enum class and the associated
parameters listed in <a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams" title="litebird_sim.gaindrifts.GainDriftParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">GainDriftParams</span></code></a>.</p>
<p>The mismatched timestream is then scaled and passed through a
responsivity function to obtain the thermal gain factor
(<span class="math notranslate nohighlight">\(\sigma\)</span>):</p>
<div class="math notranslate nohighlight">
\[\sigma = \text{responsivity_function}\left(1+\frac{ t^{(mis)}_{stream} \times \delta_T }{T_{bath}}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta_T\)</span> is the amplitude of the thermal gain
fluctuation in Kelvin unit, specified with attribute
<a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams.thermal_fluctuation_amplitude_K" title="litebird_sim.gaindrifts.GainDriftParams.thermal_fluctuation_amplitude_K"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GainDriftParams.thermal_fluctuation_amplitude_K</span></code></a>, and
<span class="math notranslate nohighlight">\(T_{bath}\)</span> is the temperature of the focalplane in Kelvin unit
specified with the attribute
<a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams.focalplane_Tbath_K" title="litebird_sim.gaindrifts.GainDriftParams.focalplane_Tbath_K"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GainDriftParams.focalplane_Tbath_K</span></code></a>.</p>
<p>The following example shows the comparison of thermal gain drift
factor with or without detector mismatch over 100 seconds.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">litebird_sim</span> <span class="k">as</span> <span class="nn">lbs</span>
<span class="kn">from</span> <span class="nn">astropy.time</span> <span class="kn">import</span> <span class="n">Time</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="s2">&quot;2034-05-02&quot;</span><span class="p">)</span>
<span class="n">duration_s</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">sampling_freq_Hz</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Creating a list of detectors. The three detectors belong to two</span>
<span class="c1"># different wafer groups.</span>
<span class="n">dets</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">lbs</span><span class="o">.</span><span class="n">DetectorInfo</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;det_A_wafer_1&quot;</span><span class="p">,</span> <span class="n">sampling_rate_hz</span><span class="o">=</span><span class="n">sampling_freq_Hz</span><span class="p">,</span> <span class="n">wafer</span><span class="o">=</span><span class="s2">&quot;wafer_1&quot;</span>
    <span class="p">),</span>
    <span class="n">lbs</span><span class="o">.</span><span class="n">DetectorInfo</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;det_B_wafer_1&quot;</span><span class="p">,</span> <span class="n">sampling_rate_hz</span><span class="o">=</span><span class="n">sampling_freq_Hz</span><span class="p">,</span> <span class="n">wafer</span><span class="o">=</span><span class="s2">&quot;wafer_1&quot;</span>
    <span class="p">),</span>
    <span class="n">lbs</span><span class="o">.</span><span class="n">DetectorInfo</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;det_C_wafer_2&quot;</span><span class="p">,</span> <span class="n">sampling_rate_hz</span><span class="o">=</span><span class="n">sampling_freq_Hz</span><span class="p">,</span> <span class="n">wafer</span><span class="o">=</span><span class="s2">&quot;wafer_2&quot;</span>
    <span class="p">),</span>
<span class="p">]</span>

<span class="c1"># Defining the gain drift simulation parameters with no detector mismatch</span>
<span class="n">drift_params_no_mismatch</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">GainDriftParams</span><span class="p">(</span>
    <span class="n">drift_type</span><span class="o">=</span><span class="n">lbs</span><span class="o">.</span><span class="n">GainDriftType</span><span class="o">.</span><span class="n">THERMAL_GAIN</span><span class="p">,</span>
    <span class="n">focalplane_group</span><span class="o">=</span><span class="s2">&quot;wafer&quot;</span><span class="p">,</span>
    <span class="n">detector_mismatch</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Defining the gain drift simulation parameters with detector mismatch</span>
<span class="n">drift_params_with_mismatch</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">GainDriftParams</span><span class="p">(</span>
    <span class="n">drift_type</span><span class="o">=</span><span class="n">lbs</span><span class="o">.</span><span class="n">GainDriftType</span><span class="o">.</span><span class="n">THERMAL_GAIN</span><span class="p">,</span>
    <span class="n">focalplane_group</span><span class="o">=</span><span class="s2">&quot;wafer&quot;</span><span class="p">,</span>
    <span class="n">detector_mismatch</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">sim1</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span>
    <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
    <span class="n">duration_s</span><span class="o">=</span><span class="n">duration_s</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">sim1</span><span class="o">.</span><span class="n">create_observations</span><span class="p">(</span>
    <span class="n">detectors</span><span class="o">=</span><span class="n">dets</span><span class="p">,</span>
    <span class="n">split_list_over_processes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">num_of_obs_per_detector</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">thermalgain_tod_no_mismatch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span>
    <span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tod</span>
<span class="p">)</span>
<span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">thermalgain_tod_with_mismatch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span>
    <span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tod</span>
<span class="p">)</span>

<span class="c1"># Generating the gain drift factors with no detector mismatch</span>
<span class="n">sim1</span><span class="o">.</span><span class="n">apply_gaindrift</span><span class="p">(</span>
    <span class="n">drift_params</span><span class="o">=</span><span class="n">drift_params_no_mismatch</span><span class="p">,</span>
    <span class="n">component</span><span class="o">=</span><span class="s2">&quot;thermalgain_tod_no_mismatch&quot;</span><span class="p">,</span>
    <span class="n">user_seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Generating the gain drift factors with detector mismatch</span>
<span class="n">sim1</span><span class="o">.</span><span class="n">apply_gaindrift</span><span class="p">(</span>
    <span class="n">drift_params</span><span class="o">=</span><span class="n">drift_params_with_mismatch</span><span class="p">,</span>
    <span class="n">component</span><span class="o">=</span><span class="s2">&quot;thermalgain_tod_with_mismatch&quot;</span><span class="p">,</span>
    <span class="n">user_seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tod</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">thermalgain_tod_no_mismatch</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="n">label</span><span class="o">=</span><span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
    <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time (in seconds)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Linear gain factor amplitude&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Thermal gain drift factor with no detector mismatch&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tod</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">thermalgain_tod_with_mismatch</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="n">label</span><span class="o">=</span><span class="n">sim1</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
    <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time (in seconds)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Linear gain factor amplitude&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Thermal gain drift factor with detector mismatch&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="_downloads/2c527c73c72e71d690b18bccd1971129/thermalgain_demo.py"><code class="xref download docutils literal notranslate"><span class="pre">Source</span> <span class="pre">code</span></code></a>, <a class="reference download internal" download="" href="_downloads/0c513417754328995f29c097b59265ce/thermalgain_demo.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="_downloads/10c1d16889c045ddb83df88beba2aa51/thermalgain_demo.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="_downloads/b003556039a3163cc1458edbb410683a/thermalgain_demo.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="_images/thermalgain_demo.png" class="plot-directive" src="_images/thermalgain_demo.png" />
</figure>
<p>In the plots above, when there is no detector mismatch,
<code class="docutils literal notranslate"><span class="pre">det_A_wafer_1</span></code> and <code class="docutils literal notranslate"><span class="pre">det_B_wafer_1</span></code> have the same gain drift
factor as they belong to the same focal plane group (grouped by wafer
name). However, when the detector mismatch is enabled, the two gain
drift factors have the same shape due to the same underlying noise
timestream but differ slightly in amplitude due to an additional
random mismatch factor.</p>
</section>
<section id="module-litebird_sim.gaindrifts">
<span id="api-reference"></span><span id="gd-api-reference"></span><h2>API reference<a class="headerlink" href="#module-litebird_sim.gaindrifts" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.GainDriftParams">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">litebird_sim.gaindrifts.</span></span><span class="sig-name descname"><span class="pre">GainDriftParams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampling_uniform_low</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_uniform_high</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_gaussian_loc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_gaussian_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drift_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftType" title="litebird_sim.gaindrifts.GainDriftType"><span class="pre">GainDriftType</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">GainDriftType.LINEAR_GAIN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_drift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_dist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#litebird_sim.gaindrifts.SamplingDist" title="litebird_sim.gaindrifts.SamplingDist"><span class="pre">SamplingDist</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">SamplingDist.UNIFORM</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibration_period_sec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">86400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focalplane_group</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'wafer'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oversample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fknee_drift_mHz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_drift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_mismatch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermal_fluctuation_amplitude_K</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focalplane_Tbath_K</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#litebird_sim.gaindrifts.GainDriftParams" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to store the gain drift injection parameters.</p>
<p>The gain drift type can be one of the following:</p>
<ul class="simple">
<li><p>Linear: It simulates gain drift that increases linearly in time. The
gain factor resets to one periodically with time interval specified by the
attribute <a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams.calibration_period_sec" title="litebird_sim.gaindrifts.GainDriftParams.calibration_period_sec"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GainDriftParams.calibration_period_sec</span></code></a>.</p></li>
<li><p>Thermal: It simulates the gain drift as the fluctuation in the
focalplane temperature. It offers the possibility to inject common mode drift
to the TODs of detectors belonging to the same group of detectors identified
by the attribute <a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams.focalplane_group" title="litebird_sim.gaindrifts.GainDriftParams.focalplane_group"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GainDriftParams.focalplane_group</span></code></a>. This is
enabled by setting the attribute <a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams.detector_mismatch" title="litebird_sim.gaindrifts.GainDriftParams.detector_mismatch"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GainDriftParams.detector_mismatch</span></code></a> to 0.</p></li>
</ul>
<p>The complete list of parameters is provided here:</p>
<ul>
<li><p>Parameters common for the simulation of all types of gain drifts:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">drift_type</span></code> (<a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftType" title="litebird_sim.gaindrifts.GainDriftType"><code class="xref py py-class docutils literal notranslate"><span class="pre">GainDriftType</span></code></a>):
Enumeration to determine the type of gain drift to be simulated.
See <a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftType" title="litebird_sim.gaindrifts.GainDriftType"><code class="xref py py-class docutils literal notranslate"><span class="pre">GainDriftType</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sigma_drift</span></code> (<cite>float</cite>): A dimensionless parameter that
determines the slope of gain drift in case of linear gain drift, and
amplitude of thermal fluctuation in case of thermal gain drift.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sampling_dist</span></code> (<a class="reference internal" href="#litebird_sim.gaindrifts.SamplingDist" title="litebird_sim.gaindrifts.SamplingDist"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamplingDist</span></code></a>): Enumeration
to specify the distribution of the random scaling/mismatch
factor applied on the gain drift. See <a class="reference internal" href="#litebird_sim.gaindrifts.SamplingDist" title="litebird_sim.gaindrifts.SamplingDist"><code class="xref py py-class docutils literal notranslate"><span class="pre">SamplingDist</span></code></a>.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Parameters that are specific to the simulation of linear gain drift:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">calibration_period_sec</span></code> (<cite>int</cite>): This is the time
period in seconds after which the linear gain drift resets periodically.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Parameters that are specific to the simulation of thermal gain drift:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">focalplane_group</span></code> (<cite>str</cite>): Detector attribute to
group the detectors. It is used to simulate same noise timestream
for all the detectors belonging to a given group. It can be any of the
detector attributes like <cite>“wafer”</cite>, <cite>“pixtype”</cite> or <cite>“channel”</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">oversample</span></code> (<cite>int</cite>): The factor by which to oversample
thermal noise FFT beyond the TOD size.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fknee_drift_mHz</span></code> (<cite>float</cite>): <span class="math notranslate nohighlight">\(f_{knee}\)</span> of the thermal drift
power spectral density given in mHz.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alpha_drift</span></code> (<cite>float</cite>): The spectral index of thermal
drift power spectral density.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">detector_mismatch</span></code> (<cite>float</cite>): The factor that determines
the degree of mismatch in thermal fluctuation of detectors belonging
to same focalplane group. A value other than 0 implies no common
gain. Whereas a value 0 sets the thermal gain to be same for all
detectors in a focalplane group.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">thermal_fluctuation_amplitude_K</span></code> (<cite>float</cite>): Amplitude of
thermal gain fluctuation in Kelvin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">focalplane_Tbath_K</span></code> (<cite>float</cite>): Temperature of the
focalplane in Kelvin.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Parameters for the sampling distributions:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sampling_uniform_low</span></code> (<cite>float</cite>): Lower boundary of the output for uniform
distribution.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sampling_uniform_high</span></code> (<cite>float</cite>): Upper boundary of the output for uniform
distribution.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sampling_gaussian_loc</span></code> (<cite>float</cite>): Mean of the Gaussian distribution.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sampling_gaussian_scale</span></code> (<cite>float</cite>): Standard deviation of the Gaussian
distribution.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<dl class="py attribute">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.GainDriftParams.alpha_drift">
<span class="sig-name descname"><span class="pre">alpha_drift</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#litebird_sim.gaindrifts.GainDriftParams.alpha_drift" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.GainDriftParams.calibration_period_sec">
<span class="sig-name descname"><span class="pre">calibration_period_sec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">86400</span></em><a class="headerlink" href="#litebird_sim.gaindrifts.GainDriftParams.calibration_period_sec" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.GainDriftParams.detector_mismatch">
<span class="sig-name descname"><span class="pre">detector_mismatch</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#litebird_sim.gaindrifts.GainDriftParams.detector_mismatch" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.GainDriftParams.drift_type">
<span class="sig-name descname"><span class="pre">drift_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftType" title="litebird_sim.gaindrifts.GainDriftType"><span class="pre">GainDriftType</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#litebird_sim.gaindrifts.GainDriftParams.drift_type" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.GainDriftParams.fknee_drift_mHz">
<span class="sig-name descname"><span class="pre">fknee_drift_mHz</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">20.0</span></em><a class="headerlink" href="#litebird_sim.gaindrifts.GainDriftParams.fknee_drift_mHz" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.GainDriftParams.focalplane_Tbath_K">
<span class="sig-name descname"><span class="pre">focalplane_Tbath_K</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.1</span></em><a class="headerlink" href="#litebird_sim.gaindrifts.GainDriftParams.focalplane_Tbath_K" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.GainDriftParams.focalplane_group">
<span class="sig-name descname"><span class="pre">focalplane_group</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'wafer'</span></em><a class="headerlink" href="#litebird_sim.gaindrifts.GainDriftParams.focalplane_group" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.GainDriftParams.oversample">
<span class="sig-name descname"><span class="pre">oversample</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#litebird_sim.gaindrifts.GainDriftParams.oversample" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.GainDriftParams.sampling_dist">
<span class="sig-name descname"><span class="pre">sampling_dist</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#litebird_sim.gaindrifts.SamplingDist" title="litebird_sim.gaindrifts.SamplingDist"><span class="pre">SamplingDist</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#litebird_sim.gaindrifts.GainDriftParams.sampling_dist" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.GainDriftParams.sampling_gaussian_loc">
<span class="sig-name descname"><span class="pre">sampling_gaussian_loc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.7</span></em><a class="headerlink" href="#litebird_sim.gaindrifts.GainDriftParams.sampling_gaussian_loc" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.GainDriftParams.sampling_gaussian_scale">
<span class="sig-name descname"><span class="pre">sampling_gaussian_scale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.5</span></em><a class="headerlink" href="#litebird_sim.gaindrifts.GainDriftParams.sampling_gaussian_scale" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.GainDriftParams.sampling_uniform_high">
<span class="sig-name descname"><span class="pre">sampling_uniform_high</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#litebird_sim.gaindrifts.GainDriftParams.sampling_uniform_high" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.GainDriftParams.sampling_uniform_low">
<span class="sig-name descname"><span class="pre">sampling_uniform_low</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#litebird_sim.gaindrifts.GainDriftParams.sampling_uniform_low" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.GainDriftParams.sigma_drift">
<span class="sig-name descname"><span class="pre">sigma_drift</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.01</span></em><a class="headerlink" href="#litebird_sim.gaindrifts.GainDriftParams.sigma_drift" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.GainDriftParams.thermal_fluctuation_amplitude_K">
<span class="sig-name descname"><span class="pre">thermal_fluctuation_amplitude_K</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#litebird_sim.gaindrifts.GainDriftParams.thermal_fluctuation_amplitude_K" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.GainDriftType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">litebird_sim.gaindrifts.</span></span><span class="sig-name descname"><span class="pre">GainDriftType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#litebird_sim.gaindrifts.GainDriftType" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">IntEnum</span></code></p>
<p>An enumeration class to specify the type of gain drift injection.</p>
<p>The gain drift type can be:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">LINEAR_GAIN</span></code>: To inject linear gain drift in time with the
possibility to calibrate the detectors at periodic interval</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">THERMAL_GAIN</span></code>: To inject a gain drift with <span class="math notranslate nohighlight">\(1/f\)</span> psd
mimicking the fluctuations in the focalplane temperature</p></li>
</ul>
<dl class="py attribute">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.GainDriftType.LINEAR_GAIN">
<span class="sig-name descname"><span class="pre">LINEAR_GAIN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#litebird_sim.gaindrifts.GainDriftType.LINEAR_GAIN" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.GainDriftType.THERMAL_GAIN">
<span class="sig-name descname"><span class="pre">THERMAL_GAIN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#litebird_sim.gaindrifts.GainDriftType.THERMAL_GAIN" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.SamplingDist">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">litebird_sim.gaindrifts.</span></span><span class="sig-name descname"><span class="pre">SamplingDist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#litebird_sim.gaindrifts.SamplingDist" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">IntEnum</span></code></p>
<p>An enumeration class to specify the distribution for the random
scaling factor applied on the gain drift. For linear gain drift, it
specifies the distribution of the slope of the gain drift. In case of
thermal gain drift, it specifies the distribution of the detector
mismatch.</p>
<p>The implemented distributions are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">UNIFORM</span></code>: Uniform distribution. The lower and upper bound of the
uniform distribution can be specified by the attributes
<a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams.sampling_uniform_low" title="litebird_sim.gaindrifts.GainDriftParams.sampling_uniform_low"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GainDriftParams.sampling_uniform_low</span></code></a> and
<a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams.sampling_uniform_high" title="litebird_sim.gaindrifts.GainDriftParams.sampling_uniform_high"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GainDriftParams.sampling_uniform_high</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GAUSSIAN</span></code>: Normal (Gaussian) distribution. The mean and standard
deviation of the Gaussian distribution can be specified by the
attributes <a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams.sampling_gaussian_loc" title="litebird_sim.gaindrifts.GainDriftParams.sampling_gaussian_loc"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GainDriftParams.sampling_gaussian_loc</span></code></a> and
<a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams.sampling_gaussian_scale" title="litebird_sim.gaindrifts.GainDriftParams.sampling_gaussian_scale"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GainDriftParams.sampling_gaussian_scale</span></code></a>.</p></li>
</ul>
<dl class="py attribute">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.SamplingDist.GAUSSIAN">
<span class="sig-name descname"><span class="pre">GAUSSIAN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#litebird_sim.gaindrifts.SamplingDist.GAUSSIAN" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.SamplingDist.UNIFORM">
<span class="sig-name descname"><span class="pre">UNIFORM</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#litebird_sim.gaindrifts.SamplingDist.UNIFORM" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.apply_gaindrift_for_one_detector">
<span class="sig-prename descclassname"><span class="pre">litebird_sim.gaindrifts.</span></span><span class="sig-name descname"><span class="pre">apply_gaindrift_for_one_detector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">det_tod</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_freq_hz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">det_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drift_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams" title="litebird_sim.gaindrifts.GainDriftParams"><span class="pre">GainDriftParams</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focalplane_attr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_timestream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">12345</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#litebird_sim.gaindrifts.apply_gaindrift_for_one_detector" title="Link to this definition">#</a></dt>
<dd><p>This function applies the gain drift on the TOD corresponding to only one
detector.</p>
<p>The linear drift is applied on the TODs in a periodic way with the period size
specified in seconds by <code class="docutils literal notranslate"><span class="pre">drift_params.callibration_period_sec</span></code>. This is by
assuming that the detectors are calibrated for linear gain drift periodically.
The slope of the linear gain is determined randomly based on the detector name
and the user-provided seed.</p>
<p>The thermal gain drift, on the other hand, is based on the fluctuation of the
focalplane temperature modeled after <span class="math notranslate nohighlight">\(1/f\)</span> power spectral
density (PSD). This <span class="math notranslate nohighlight">\(1/f\)</span>
PSD is common to all the detectors belonging to the focalplane group identified
by <code class="docutils literal notranslate"><span class="pre">drift_params.focalplane_group</span></code>. The function provides an option to introduce a
mismatch between the individual detectors within a focalplane group with the
parameter <code class="docutils literal notranslate"><span class="pre">drift_params.detector_mismatch</span></code>. This mismatch parameter along with a
random number determines the extent of the mismatch of the thermal fluctuation
within the focalplane group. Finally the thermal fluctuation is applied to the TODs
according to the responsivity function of the detectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>det_tod</strong> (<em>np.ndarray</em>) – The TOD array corresponding to only one
detector.</p></li>
<li><p><strong>sampling_freq_hz</strong> (<em>float</em>) – The sampling frequency of the detector in Hz.</p></li>
<li><p><strong>det_name</strong> (<em>str</em>) – The name of the detector to which the TOD belongs.
This name is used with <code class="docutils literal notranslate"><span class="pre">user_seed</span></code> to generate hash. This hash is used to
set random slope in case of linear drift, and randomized detector mismatch
in case of thermal gain drift.</p></li>
<li><p><strong>drift_params</strong> (<a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams" title="litebird_sim.gaindrifts.GainDriftParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">GainDriftParams</span></code></a>, optional) – The gain drift
injection parameters object. Defaults to None.</p></li>
<li><p><strong>focalplane_attr</strong> (<em>str</em><em>, </em><em>optional</em>) – This is the parameter
corresponding to the <code class="docutils literal notranslate"><span class="pre">drift_params.focalplane_group</span></code> attribute.
For example, if <code class="docutils literal notranslate"><span class="pre">drift_params.focalplane_group</span> <span class="pre">=</span> <span class="pre">'wafer'</span></code>, the
<code class="docutils literal notranslate"><span class="pre">focalplane_attr</span></code> will be the name of the detector wafer. Defaults to None.</p></li>
<li><p><strong>noise_timestream</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – The thermal noise time
stream. Defaults to None.</p></li>
<li><p><strong>user_seed</strong> (<em>int</em><em>, </em><em>optional</em>) – A seed provided by the user. Defaults
to 12345.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.apply_gaindrift_to_observations">
<span class="sig-prename descclassname"><span class="pre">litebird_sim.gaindrifts.</span></span><span class="sig-name descname"><span class="pre">apply_gaindrift_to_observations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="observations.html#litebird_sim.observations.Observation" title="litebird_sim.observations.Observation"><span class="pre">Observation</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="observations.html#litebird_sim.observations.Observation" title="litebird_sim.observations.Observation"><span class="pre">Observation</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drift_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams" title="litebird_sim.gaindrifts.GainDriftParams"><span class="pre">GainDriftParams</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">12345</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'tod'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#litebird_sim.gaindrifts.apply_gaindrift_to_observations" title="Link to this definition">#</a></dt>
<dd><p>The function to apply gain drift to the TOD of a <a class="reference internal" href="observations.html#litebird_sim.observations.Observation" title="litebird_sim.observations.Observation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Observation</span></code></a>
instance or a list of observations.</p>
<p>This function is a wrapper around <a class="reference internal" href="#litebird_sim.gaindrifts.apply_gaindrift_to_tod" title="litebird_sim.gaindrifts.apply_gaindrift_to_tod"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_gaindrift_to_tod()</span></code></a>
that injects gain drift to the TOD object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>observations</strong> (<em>Union</em><em>[</em><a class="reference internal" href="observations.html#litebird_sim.observations.Observation" title="litebird_sim.observations.Observation"><em>Observation</em></a><em>, </em><em>List</em><em>[</em><a class="reference internal" href="observations.html#litebird_sim.observations.Observation" title="litebird_sim.observations.Observation"><em>Observation</em></a><em>]</em><em>]</em>) – An instance or a list
of instances of <a class="reference internal" href="observations.html#litebird_sim.observations.Observation" title="litebird_sim.observations.Observation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Observation</span></code></a>.</p></li>
<li><p><strong>drift_params</strong> (<a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams" title="litebird_sim.gaindrifts.GainDriftParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">GainDriftParams</span></code></a>, optional) – The gain drift
injection parameters object. Defaults to None.</p></li>
<li><p><strong>user_seed</strong> (<em>int</em><em>, </em><em>optional</em>) – A seed provided by the user. Defaults
to 12345.</p></li>
<li><p><strong>component</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the TOD on which the gain
drift has to be injected. Defaults to “tod”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="litebird_sim.gaindrifts.apply_gaindrift_to_tod">
<span class="sig-prename descclassname"><span class="pre">litebird_sim.gaindrifts.</span></span><span class="sig-name descname"><span class="pre">apply_gaindrift_to_tod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tod</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_freq_hz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">det_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drift_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams" title="litebird_sim.gaindrifts.GainDriftParams"><span class="pre">GainDriftParams</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focalplane_attr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">12345</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#litebird_sim.gaindrifts.apply_gaindrift_to_tod" title="Link to this definition">#</a></dt>
<dd><p>The function to apply the gain drift to all the detectors of a given TOD object.</p>
<p>This function is a wrapper around <a class="reference internal" href="#litebird_sim.gaindrifts.apply_gaindrift_for_one_detector" title="litebird_sim.gaindrifts.apply_gaindrift_for_one_detector"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_gaindrift_for_one_detector()</span></code></a>
that applies the gain drift on each detector TODs of the TOD object. In case of
thermal gain drift injection, this function computes the thermal noise
fluctuations at once for all the detectors belonging to the focalplane group
specified by <code class="docutils literal notranslate"><span class="pre">drift_params.focalplane_group</span></code> and passes them to
<a class="reference internal" href="#litebird_sim.gaindrifts.apply_gaindrift_for_one_detector" title="litebird_sim.gaindrifts.apply_gaindrift_for_one_detector"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_gaindrift_for_one_detector()</span></code></a> with individual TOD arrays to inject
thermal gain drift.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tod</strong> (<em>np.ndarray</em>) – The TOD object consisting TOD arrays for
multiple detectors.</p></li>
<li><p><strong>sampling_freq_hz</strong> (<em>float</em>) – The sampling frequency of the detector in Hz.</p></li>
<li><p><strong>det_name</strong> (<em>Union</em><em>[</em><em>List</em><em>, </em><em>np.ndarray</em><em>]</em>) – The list of the name of the
detectors to which the TOD arrays correspond. The detector names
are used to generate unique and reproducible random numbers for
each detector.</p></li>
<li><p><strong>drift_params</strong> (<a class="reference internal" href="#litebird_sim.gaindrifts.GainDriftParams" title="litebird_sim.gaindrifts.GainDriftParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">GainDriftParams</span></code></a>, optional) – The gain drift
injection parameters object. Defaults to None.</p></li>
<li><p><strong>focalplane_attr</strong> (<em>Union</em><em>[</em><em>List</em><em>, </em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – This is the
parameter corresponding to the <code class="docutils literal notranslate"><span class="pre">drift_params.focalplane_group</span></code>
attribute. For example, if
<code class="docutils literal notranslate"><span class="pre">drift_params.focalplane_group</span> <span class="pre">=</span> <span class="pre">'wafer'</span></code>, the
<code class="docutils literal notranslate"><span class="pre">focalplane_attr</span></code> will be the list of the names of detector
wafer. Defaults to None.</p></li>
<li><p><strong>user_seed</strong> (<em>int</em><em>, </em><em>optional</em>) – A seed provided by the user. Defaults
to 12345.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="part4.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Systematic effects</p>
      </div>
    </a>
    <a class="right-next"
       href="non_linearity.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Non-linearity injection</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-gain-drift">Linear gain drift</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermal-gain-drift">Thermal gain drift</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-litebird_sim.gaindrifts">API reference</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.GainDriftParams"><code class="docutils literal notranslate"><span class="pre">GainDriftParams</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.GainDriftParams.alpha_drift"><code class="docutils literal notranslate"><span class="pre">GainDriftParams.alpha_drift</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.GainDriftParams.calibration_period_sec"><code class="docutils literal notranslate"><span class="pre">GainDriftParams.calibration_period_sec</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.GainDriftParams.detector_mismatch"><code class="docutils literal notranslate"><span class="pre">GainDriftParams.detector_mismatch</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.GainDriftParams.drift_type"><code class="docutils literal notranslate"><span class="pre">GainDriftParams.drift_type</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.GainDriftParams.fknee_drift_mHz"><code class="docutils literal notranslate"><span class="pre">GainDriftParams.fknee_drift_mHz</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.GainDriftParams.focalplane_Tbath_K"><code class="docutils literal notranslate"><span class="pre">GainDriftParams.focalplane_Tbath_K</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.GainDriftParams.focalplane_group"><code class="docutils literal notranslate"><span class="pre">GainDriftParams.focalplane_group</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.GainDriftParams.oversample"><code class="docutils literal notranslate"><span class="pre">GainDriftParams.oversample</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.GainDriftParams.sampling_dist"><code class="docutils literal notranslate"><span class="pre">GainDriftParams.sampling_dist</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.GainDriftParams.sampling_gaussian_loc"><code class="docutils literal notranslate"><span class="pre">GainDriftParams.sampling_gaussian_loc</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.GainDriftParams.sampling_gaussian_scale"><code class="docutils literal notranslate"><span class="pre">GainDriftParams.sampling_gaussian_scale</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.GainDriftParams.sampling_uniform_high"><code class="docutils literal notranslate"><span class="pre">GainDriftParams.sampling_uniform_high</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.GainDriftParams.sampling_uniform_low"><code class="docutils literal notranslate"><span class="pre">GainDriftParams.sampling_uniform_low</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.GainDriftParams.sigma_drift"><code class="docutils literal notranslate"><span class="pre">GainDriftParams.sigma_drift</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.GainDriftParams.thermal_fluctuation_amplitude_K"><code class="docutils literal notranslate"><span class="pre">GainDriftParams.thermal_fluctuation_amplitude_K</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.GainDriftType"><code class="docutils literal notranslate"><span class="pre">GainDriftType</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.GainDriftType.LINEAR_GAIN"><code class="docutils literal notranslate"><span class="pre">GainDriftType.LINEAR_GAIN</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.GainDriftType.THERMAL_GAIN"><code class="docutils literal notranslate"><span class="pre">GainDriftType.THERMAL_GAIN</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.SamplingDist"><code class="docutils literal notranslate"><span class="pre">SamplingDist</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.SamplingDist.GAUSSIAN"><code class="docutils literal notranslate"><span class="pre">SamplingDist.GAUSSIAN</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.SamplingDist.UNIFORM"><code class="docutils literal notranslate"><span class="pre">SamplingDist.UNIFORM</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.apply_gaindrift_for_one_detector"><code class="docutils literal notranslate"><span class="pre">apply_gaindrift_for_one_detector()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.apply_gaindrift_to_observations"><code class="docutils literal notranslate"><span class="pre">apply_gaindrift_to_observations()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.gaindrifts.apply_gaindrift_to_tod"><code class="docutils literal notranslate"><span class="pre">apply_gaindrift_to_tod()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="_sources/gaindrifts.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2020, The LiteBIRD Simulation Team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>