
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Instrumental noise &#8212; LBS 0.13.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/asciinema-player_2.6.1.css" />
    <link rel="stylesheet" type="text/css" href="_static/asciinema-custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/contentui.css" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=1019fba8"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/asciinema-player_2.6.1.js"></script>
    <script src="_static/contentui.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'noise';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Synthetic sky maps" href="sky_maps.html" />
    <link rel="prev" title="Ideal Half Wave Plate" href="hwp.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">LBS 0.13.0 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="part1.html">
    Introduction
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part2.html">
    Structure of the framework
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="part3.html">
    Basic simulation modules
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part4.html">
    Systematic effects
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part5.html">
    Data-reduction modules
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="part6.html">
    Tutorials
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="appendix.html">
    Appendices
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="installation.html">
    Installation
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="part1.html">
    Introduction
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part2.html">
    Structure of the framework
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="part3.html">
    Basic simulation modules
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part4.html">
    Systematic effects
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part5.html">
    Data-reduction modules
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="part6.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="appendix.html">
    Appendices
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="installation.html">
    Installation
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="scanning.html">Scanning strategy</a></li>
<li class="toctree-l1"><a class="reference internal" href="quaternions.html">Quaternions</a></li>
<li class="toctree-l1"><a class="reference internal" href="hwp.html">Ideal Half Wave Plate</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Instrumental noise</a></li>
<li class="toctree-l1"><a class="reference internal" href="sky_maps.html">Synthetic sky maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="dipole.html">Dipole anisotropy</a></li>
<li class="toctree-l1"><a class="reference internal" href="map_scanning.html">Scanning a map to fill a TOD</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="part3.html" class="nav-link">Basic simulation modules</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Instrumental noise</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="instrumental-noise">
<span id="noise"></span><h1>Instrumental noise<a class="headerlink" href="#instrumental-noise" title="Link to this heading">#</a></h1>
<p>The ability to add noise to your detector timestreams is supported through the
function <a class="reference internal" href="#litebird_sim.noise.add_noise_to_observations" title="litebird_sim.noise.add_noise_to_observations"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_noise_to_observations()</span></code></a> and the low-level versions
<a class="reference internal" href="#litebird_sim.noise.add_noise" title="litebird_sim.noise.add_noise"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_noise()</span></code></a>, <a class="reference internal" href="#litebird_sim.noise.add_white_noise" title="litebird_sim.noise.add_white_noise"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_white_noise()</span></code></a>, and
<a class="reference internal" href="#litebird_sim.noise.add_one_over_f_noise" title="litebird_sim.noise.add_one_over_f_noise"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_one_over_f_noise()</span></code></a>.</p>
<p>Here is a short example that shows how to add noise:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">litebird_sim</span> <span class="k">as</span> <span class="nn">lbs</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Create a simulation lasting 100 seconds</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span>
    <span class="n">base_path</span><span class="o">=</span><span class="s1">&#39;./output&#39;</span><span class="p">,</span>
    <span class="n">start_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">duration_s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Create a detector object</span>
<span class="n">det</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">DetectorInfo</span><span class="p">(</span>
  <span class="n">net_ukrts</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
  <span class="n">sampling_rate_hz</span><span class="o">=</span><span class="mi">10</span>
<span class="p">)</span>

<span class="n">obs</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">create_observations</span><span class="p">(</span><span class="n">detectors</span><span class="o">=</span><span class="p">[</span><span class="n">det</span><span class="p">])</span>

<span class="c1"># Here we add white noise using the detector</span>
<span class="c1"># noise parameters from the `det` object.</span>
<span class="c1"># We use the random number generator provided</span>
<span class="c1"># by `sim`, which is initialized with the</span>
<span class="c1"># seed we passed to the Simulation constructor</span>
<span class="c1"># to ensure repeatability.</span>
<span class="n">lbs</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">add_noise_to_observations</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">random</span><span class="o">=</span><span class="n">sim</span><span class="o">.</span><span class="n">random</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">obs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tod</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.5e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>5.65263e-04
-1.54522e-04
3.42276e-04
-1.42274e-04
-1.71110e-04
8.72188e-05
-1.23400e-04
-6.99311e-05
6.58389e-05
5.51306e-04
</pre></div>
</div>
<p>Note that we pass <code class="docutils literal notranslate"><span class="pre">sim.random</span></code> as the number generator to use.
This is a member variable that is initialized by the constructor
of the class <a class="reference internal" href="simulations.html#litebird_sim.simulations.Simulation" title="litebird_sim.simulations.Simulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulation</span></code></a>, and it is safe to be used with
multiple MPI processes as it ensures that each process has its
own random number generator with a different seed. You can also
pass another random number generator, as long as it has the
<code class="docutils literal notranslate"><span class="pre">normal</span></code> method. More information on the generation of random
numbers can be found in <a class="reference internal" href="random_numbers.html#random-numbers"><span class="std std-ref">Random numbers</span></a>.</p>
<p>To add white noise using a custom white noise sigma, in µK, we can
call the low level function directly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">litebird_sim</span> <span class="k">as</span> <span class="nn">lbs</span>

<span class="n">sim</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span>
    <span class="n">base_path</span><span class="o">=</span><span class="s1">&#39;./output&#39;</span><span class="p">,</span>
    <span class="n">start_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">duration_s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">det</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">DetectorInfo</span><span class="p">(</span>
  <span class="n">net_ukrts</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
  <span class="n">sampling_rate_hz</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">obs</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">create_observations</span><span class="p">(</span><span class="n">detectors</span><span class="o">=</span><span class="p">[</span><span class="n">det</span><span class="p">])</span>

<span class="n">custom_sigma_uk</span> <span class="o">=</span> <span class="mi">1234</span>
<span class="n">lbs</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">add_white_noise</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tod</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">custom_sigma_uk</span><span class="p">,</span> <span class="n">random</span><span class="o">=</span><span class="n">sim</span><span class="o">.</span><span class="n">random</span><span class="p">)</span>
</pre></div>
</div>
<p>We can also add 1/f noise using a very similar call to the above:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">litebird_sim</span> <span class="k">as</span> <span class="nn">lbs</span>

<span class="n">sim</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span>
    <span class="n">base_path</span><span class="o">=</span><span class="s1">&#39;./output&#39;</span><span class="p">,</span>
    <span class="n">start_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">duration_s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">det</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">DetectorInfo</span><span class="p">(</span>
  <span class="n">net_ukrts</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
  <span class="n">sampling_rate_hz</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
  <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
  <span class="n">fknee_mhz</span><span class="o">=</span><span class="mi">10</span>
<span class="p">)</span>

<span class="n">obs</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">create_observations</span><span class="p">(</span><span class="n">detectors</span><span class="o">=</span><span class="p">[</span><span class="n">det</span><span class="p">])</span>

<span class="c1"># Here we add 1/f noise using the detector noise</span>
<span class="c1"># parameters from the detector object</span>
<span class="n">lbs</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">add_noise_to_observations</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="s1">&#39;one_over_f&#39;</span><span class="p">,</span> <span class="n">random</span><span class="o">=</span><span class="n">sim</span><span class="o">.</span><span class="n">random</span><span class="p">)</span>
</pre></div>
</div>
<p>Again, to generate noise with custom parameters, we can either use the low-level function or edit the <a class="reference internal" href="observations.html#litebird_sim.observations.Observation" title="litebird_sim.observations.Observation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Observation</span></code></a> object to contain the desired noise parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">litebird_sim</span> <span class="k">as</span> <span class="nn">lbs</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">sim</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span>
    <span class="n">base_path</span><span class="o">=</span><span class="s1">&#39;./output&#39;</span><span class="p">,</span>
    <span class="n">start_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">duration_s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">det</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">DetectorInfo</span><span class="p">(</span>
  <span class="n">net_ukrts</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
  <span class="n">sampling_rate_hz</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
  <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
  <span class="n">fknee_mhz</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
  <span class="n">fmin_hz</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">obs</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">create_observations</span><span class="p">(</span><span class="n">detectors</span><span class="o">=</span><span class="p">[</span><span class="n">det</span><span class="p">])</span>

<span class="n">custom_sigma_uk</span> <span class="o">=</span> <span class="mi">1234</span>
<span class="n">custom_fknee_mhz</span> <span class="o">=</span> <span class="mf">12.34</span>
<span class="n">custom_alpha</span> <span class="o">=</span> <span class="mf">1.234</span>
<span class="n">custom_fmin_hz</span> <span class="o">=</span> <span class="mf">0.0123</span>

<span class="c1"># Option 1: we call the low-level function directly</span>
<span class="n">lbs</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">add_one_over_f_noise</span><span class="p">(</span>
    <span class="n">obs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tod</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">custom_fknee_mhz</span><span class="p">,</span>
    <span class="n">custom_fmin_hz</span><span class="p">,</span>
    <span class="n">custom_alpha</span><span class="p">,</span>
    <span class="n">custom_sigma_uk</span><span class="p">,</span>
    <span class="n">obs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sampling_rate_hz</span><span class="p">,</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">random</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Option 2: we change the values in `obs`</span>
<span class="n">obs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fknee_mhz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">custom_fknee_mhz</span>
<span class="n">obs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fmin_hz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">custom_fmin_hz</span>
<span class="n">obs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">custom_alpha</span>
<span class="n">obs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">net_ukrts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">custom_sigma_uk</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sampling_rate_hz</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">lbs</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">add_noise_to_observations</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="s1">&#39;one_over_f&#39;</span><span class="p">,</span> <span class="n">random</span><span class="o">=</span><span class="n">sim</span><span class="o">.</span><span class="n">random</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It’s crucial to grasp the distinction between the noise level in a
timestream and the noise level in a map. While the latter is
dependent on the former, the conversion is influenced by several
factors. This understanding will empower you in your data analysis
tasks.</p>
<p>A common mistake is to use the mission time divided by the number
of pixels in the map in a call to func:<cite>.add_white_noise</cite>. This is
<strong>wrong</strong>, as the noise level per pixel depends on the overall
integration time, which is always less than the mission time
because of cosmic ray loss, repointing maneuvers, etc. These
effects reduce the number of samples in the timeline that can be
used to estimate the map, but they do not affect the noise of the
timeline.</p>
</div>
<section id="methods-of-the-simulation-class">
<h2>Methods of the Simulation class<a class="headerlink" href="#methods-of-the-simulation-class" title="Link to this heading">#</a></h2>
<p>The class <a class="reference internal" href="simulations.html#litebird_sim.simulations.Simulation" title="litebird_sim.simulations.Simulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulation</span></code></a> provides the function
<code class="xref py py-func docutils literal notranslate"><span class="pre">Simulation.add_noise()</span></code> which adds noise to the timelines.
All the details of the noise are provided in the class observation and
the interface is simplified.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">litebird_sim</span> <span class="k">as</span> <span class="nn">lbs</span>
<span class="kn">from</span> <span class="nn">astropy.time</span> <span class="kn">import</span> <span class="n">Time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">time_span_s</span> <span class="o">=</span> <span class="mf">1000.0</span>
<span class="n">sampling_hz</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">nside</span> <span class="o">=</span> <span class="mi">128</span>

<span class="n">sim</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span>
    <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
    <span class="n">duration_s</span><span class="o">=</span><span class="n">time_span_s</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># We pick a simple scanning strategy where the spin axis is aligned</span>
<span class="c1"># with the Sun-Earth axis, and the spacecraft spins once every minute</span>
<span class="n">sim</span><span class="o">.</span><span class="n">set_scanning_strategy</span><span class="p">(</span>
    <span class="n">lbs</span><span class="o">.</span><span class="n">SpinningScanningStrategy</span><span class="p">(</span>
        <span class="n">spin_sun_angle_rad</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">precession_rate_hz</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">spin_rate_hz</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">60</span><span class="p">,</span>
        <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">delta_time_s</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
 <span class="p">)</span>

<span class="c1"># We simulate an instrument whose boresight is perpendicular to</span>
<span class="c1"># the spin axis.</span>
<span class="n">sim</span><span class="o">.</span><span class="n">set_instrument</span><span class="p">(</span>
    <span class="n">lbs</span><span class="o">.</span><span class="n">InstrumentInfo</span><span class="p">(</span>
        <span class="n">boresight_rotangle_rad</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">spin_boresight_angle_rad</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="mi">90</span><span class="p">),</span>
        <span class="n">spin_rotangle_rad</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="mi">75</span><span class="p">),</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># A simple detector looking along the boresight direction</span>
<span class="n">det</span> <span class="o">=</span> <span class="n">lbs</span><span class="o">.</span><span class="n">DetectorInfo</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Boresight_detector&quot;</span><span class="p">,</span>
    <span class="n">sampling_rate_hz</span><span class="o">=</span><span class="n">sampling_hz</span><span class="p">,</span>
    <span class="n">bandcenter_ghz</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span>
    <span class="n">net_ukrts</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">sim</span><span class="o">.</span><span class="n">create_observations</span><span class="p">(</span><span class="n">detectors</span><span class="o">=</span><span class="n">det</span><span class="p">)</span>

<span class="n">sim</span><span class="o">.</span><span class="n">add_noise</span><span class="p">(</span><span class="n">noise_type</span><span class="o">=</span><span class="s1">&#39;one_over_f&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sim</span><span class="o">.</span><span class="n">observations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tod</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.5e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>2.83998e-04
-7.58942e-05
1.72505e-04
-6.97704e-05
-8.41885e-05
</pre></div>
</div>
</section>
<section id="module-litebird_sim.noise">
<span id="api-reference"></span><h2>API reference<a class="headerlink" href="#module-litebird_sim.noise" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="litebird_sim.noise.add_noise">
<span class="sig-prename descclassname"><span class="pre">litebird_sim.noise.</span></span><span class="sig-name descname"><span class="pre">add_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate_hz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">net_ukrts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fknee_mhz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin_hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#litebird_sim.noise.add_noise" title="Link to this definition">#</a></dt>
<dd><p>Add noise (white or 1/f) to a 2D array of floating-point values</p>
<p>This function sums an array of random number following a white noise model with
an optional 1/f component to <cite>data</cite>, which is assumed to be a D×N array containing
the TOD for D detectors, each containing N samples.</p>
<p>The parameter <cite>noisetype</cite> must either be <code class="docutils literal notranslate"><span class="pre">white</span></code> or <code class="docutils literal notranslate"><span class="pre">one_over_f</span></code>; in the latter
case, the noise will contain a 1/f part and a white noise part.</p>
<p>Be sure <em>not</em> to include cosmic ray loss, repointing maneuvers, etc., in the value
passed as <cite>net_ukrts</cite>, as these affect the integration time but <strong>not</strong> the white
noise per sample.</p>
<p>The parameter <cite>scale</cite> can be used to introduce measurement unit conversions when
appropriate. Default units: [K].</p>
<p>The parameter <cite>random</cite> must be specified and must be a random number generator that
implements the <code class="docutils literal notranslate"><span class="pre">normal</span></code> method. You should typically use the <cite>random</cite> field
of a <a class="reference internal" href="simulations.html#litebird_sim.simulations.Simulation" title="litebird_sim.simulations.Simulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulation</span></code></a> object for this.</p>
<p>The parameters <cite>net_ukrts</cite>, <cite>fknee_mhz</cite>, <cite>fmin_hz</cite>, <cite>alpha</cite>, and <cite>scale</cite> can
either be scalars or arrays; in the latter case, their size must be the same as
<code class="docutils literal notranslate"><span class="pre">tod.shape[0]</span></code>, which is the number of detectors in the TOD.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="litebird_sim.noise.add_noise_to_observations">
<span class="sig-prename descclassname"><span class="pre">litebird_sim.noise.</span></span><span class="sig-name descname"><span class="pre">add_noise_to_observations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="observations.html#litebird_sim.observations.Observation" title="litebird_sim.observations.Observation"><span class="pre">Observation</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="observations.html#litebird_sim.observations.Observation" title="litebird_sim.observations.Observation"><span class="pre">Observation</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Generator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'tod'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#litebird_sim.noise.add_noise_to_observations" title="Link to this definition">#</a></dt>
<dd><p>Add noise of the defined type to the observations in observations</p>
<p>This class provides an interface to the low-level function <a class="reference internal" href="#litebird_sim.noise.add_noise" title="litebird_sim.noise.add_noise"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_noise()</span></code></a>.
The parameter <cite>observations</cite> can either be one <a class="reference internal" href="observations.html#litebird_sim.observations.Observation" title="litebird_sim.observations.Observation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Observation</span></code></a> instance
or a list of observations, which are typically taken from the field
<cite>observations</cite> of a <a class="reference internal" href="simulations.html#litebird_sim.simulations.Simulation" title="litebird_sim.simulations.Simulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulation</span></code></a> object. Unlike <a class="reference internal" href="#litebird_sim.noise.add_noise" title="litebird_sim.noise.add_noise"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_noise()</span></code></a>,
it is not needed to pass the noise parameters here, as they are taken from the
characteristics of the detectors saved in <cite>observations</cite>. The parameter <cite>random</cite>
must be specified and must be a random number generator that implements the
<code class="docutils literal notranslate"><span class="pre">normal</span></code> method. You should typically use the <cite>random</cite> field of a
<a class="reference internal" href="simulations.html#litebird_sim.simulations.Simulation" title="litebird_sim.simulations.Simulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulation</span></code></a> object for this.</p>
<p>By default, the noise is added to <code class="docutils literal notranslate"><span class="pre">Observation.tod</span></code>. If you want to add it to some
other field of the <a class="reference internal" href="observations.html#litebird_sim.observations.Observation" title="litebird_sim.observations.Observation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Observation</span></code></a> class, use <cite>component</cite>:</p>
<blockquote>
<div><dl class="simple">
<dt>for cur_obs in sim.observations:</dt><dd><p># Allocate a new TOD for the noise alone
cur_obs.noise_tod = np.zeros_like(cur_obs.tod)</p>
</dd>
</dl>
<p># Ask <cite>add_noise_to_observations</cite> to store the noise
# in <cite>observations.noise_tod</cite>
add_noise_to_observations(sim.observations, …, component=”noise_tod”)</p>
</div></blockquote>
<p>See <a class="reference internal" href="#litebird_sim.noise.add_noise" title="litebird_sim.noise.add_noise"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_noise()</span></code></a> for more information.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="litebird_sim.noise.add_one_over_f_noise">
<span class="sig-prename descclassname"><span class="pre">litebird_sim.noise.</span></span><span class="sig-name descname"><span class="pre">add_one_over_f_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fknee_mhz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin_hz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate_hz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#litebird_sim.noise.add_one_over_f_noise" title="Link to this definition">#</a></dt>
<dd><p>Adds a 1/f noise timestream with the given f knee and alpha to data
To be called from add_noise_to_observations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – 1-D numpy array</p></li>
<li><p><strong>fknee_mhz</strong> – knee frequency in mHz</p></li>
<li><p><strong>fmin_hz</strong> – kmin frequency for high pass in Hz</p></li>
<li><p><strong>alpha</strong> – low frequency spectral tilt</p></li>
<li><p><strong>sigma</strong> – the white noise level per sample. Be sure <em>not</em> to include cosmic ray
loss, repointing maneuvers, etc., as these affect the integration time
but <strong>not</strong> the white noise per sample.</p></li>
<li><p><strong>sampling_rate_hz</strong> – the sampling frequency of the data</p></li>
<li><p><strong>random</strong> – a random number generator that implements the <code class="docutils literal notranslate"><span class="pre">normal</span></code> method.
You should typically use the <cite>random</cite> field of a <a class="reference internal" href="simulations.html#litebird_sim.simulations.Simulation" title="litebird_sim.simulations.Simulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulation</span></code></a>
object for this. It must be specified</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="litebird_sim.noise.add_white_noise">
<span class="sig-prename descclassname"><span class="pre">litebird_sim.noise.</span></span><span class="sig-name descname"><span class="pre">add_white_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#litebird_sim.noise.add_white_noise" title="Link to this definition">#</a></dt>
<dd><p>Adds white noise with the given sigma to the array data.</p>
<p>To be called from add_noise_to_observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – 1-D numpy array</p></li>
<li><p><strong>sigma</strong> – the white noise level per sample. Be sure <em>not</em> to include cosmic ray
loss, repointing maneuvers, etc., as these affect the integration time
but <strong>not</strong> the white noise per sample.</p></li>
<li><p><strong>random</strong> – a random number generator that implements the <code class="docutils literal notranslate"><span class="pre">normal</span></code> method.
You should typically use the <cite>random</cite> field of a <a class="reference internal" href="simulations.html#litebird_sim.simulations.Simulation" title="litebird_sim.simulations.Simulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulation</span></code></a>
object for this. It must be specified</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="litebird_sim.noise.build_one_over_f_model">
<span class="sig-prename descclassname"><span class="pre">litebird_sim.noise.</span></span><span class="sig-name descname"><span class="pre">build_one_over_f_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ft</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fknee_mhz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmin_hz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#litebird_sim.noise.build_one_over_f_model" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="litebird_sim.noise.nearest_pow2">
<span class="sig-prename descclassname"><span class="pre">litebird_sim.noise.</span></span><span class="sig-name descname"><span class="pre">nearest_pow2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#litebird_sim.noise.nearest_pow2" title="Link to this definition">#</a></dt>
<dd><p>returns the next largest power of 2 that will encompass the full data set</p>
<p>data: 1-D numpy array</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="litebird_sim.noise.rescale_noise">
<span class="sig-prename descclassname"><span class="pre">litebird_sim.noise.</span></span><span class="sig-name descname"><span class="pre">rescale_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">net_ukrts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate_hz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#litebird_sim.noise.rescale_noise" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="hwp.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Ideal Half Wave Plate</p>
      </div>
    </a>
    <a class="right-next"
       href="sky_maps.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Synthetic sky maps</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#methods-of-the-simulation-class">Methods of the Simulation class</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-litebird_sim.noise">API reference</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.noise.add_noise"><code class="docutils literal notranslate"><span class="pre">add_noise()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.noise.add_noise_to_observations"><code class="docutils literal notranslate"><span class="pre">add_noise_to_observations()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.noise.add_one_over_f_noise"><code class="docutils literal notranslate"><span class="pre">add_one_over_f_noise()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.noise.add_white_noise"><code class="docutils literal notranslate"><span class="pre">add_white_noise()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.noise.build_one_over_f_model"><code class="docutils literal notranslate"><span class="pre">build_one_over_f_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.noise.nearest_pow2"><code class="docutils literal notranslate"><span class="pre">nearest_pow2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#litebird_sim.noise.rescale_noise"><code class="docutils literal notranslate"><span class="pre">rescale_noise()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="_sources/noise.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2020, The LiteBIRD Simulation Team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>